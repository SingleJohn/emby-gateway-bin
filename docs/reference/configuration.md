# 配置说明

这篇文档给普通用户看：后台里有哪些关键配置、按什么顺序配、哪些值建议先别改。

## 1. 配置顺序（照着做最稳）

1. 先配 `Source`（入口）
2. 再配 `后端`（存储）
3. 再配 `资源池`（主备）
4. 最后配 `路由规则`（分流）

如果你是第一次使用，建议先做“单路由 + 单后端”跑通，再逐步加复杂规则。

## 2. 后台关键配置项

## Source（入口）

- 用来接收 Emby 播放请求
- 关键项：监听端口、上游 Emby 地址
- 建议：先只建 1 个 Source，验证通过后再增加

## 后端（存储）

- 支持：S3、CDN、GDrive、本地等
- 建议：每新增一个后端都先做连通性确认

## 资源池（主备）

- 把后端组合成主备关系
- 建议：生产环境必须配置备后端，降低播放失败风险

## 路由规则（分流）

- 决定哪些请求走哪个资源池
- 建议：保留一条“兜底规则”，避免请求漏匹配

## 路径映射（按需）

- 仅当 Emby 路径与后端路径不一致时才需要配置
- 常见错误：`from/to` 写反，导致请求找不到资源

## 3. 推荐默认策略

| 项目 | 建议 |
|---|---|
| Source 数量 | 初期 1 个即可 |
| 资源池 | 主后端 + 备后端 |
| 路由规则 | 先 1 条兜底规则，后续再细分 |
| 路径映射 | 路径一致就先不配 |
| 观测与日志 | 保持默认，先看稳定性再调优 |

## 4. 什么配置改完会立刻生效

- 路由、后端、资源池这类业务配置：通常保存后立即生效
- 涉及监听行为的变更（例如端口/新增入口）：通常需要重启进程

## 5. 常见配置误区

1. 只配了后端，忘了建资源池
2. 资源池建好了，路由没绑定它
3. 路由优先级冲突，命中顺序不符合预期
4. 路径映射方向写反

## 6. 高级部署项（可选）

这部分给运维使用，不是普通用户必配：

- 数据库连接方式（SQLite / PostgreSQL）
- 管理端监听地址与端口
- 授权相关启动参数与环境变量

如果你只是日常使用，按前 5 节即可。
